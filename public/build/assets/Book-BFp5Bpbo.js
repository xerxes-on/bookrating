import{_ as U}from"./Layout-66GSexvw.js";import{f as D}from"./utilities-BIASTeKs.js";import{b as C}from"./book-DQrhVAmp.js";import{r as x,I as O,A as W,d,o as i,e,O as B,t as a,F as p,f as y,g as j,n as k,j as R,$ as H,a0 as Y,_ as G,b as P,a as E,a1 as I,B as F,m as $,i as J,w as q,v as K,a2 as Q,N as L,p as X}from"./app-u9g5LOTy.js";import{c as Z}from"./client-DLA-7hpl.js";import{_ as ee,f as te}from"./FollowButton-B-9xewMH.js";import{_ as se}from"./LikeButton-CAacU1Rh.js";import{k as oe}from"./index-DqW9W4z6.js";/* empty css                                                               */const le=(s,f)=>Z.post(`/all-reviews/${s}/?page=${f}`).then(u=>u).catch(u=>u.response),ae={getReviews:le},ne={class:"mt-12 p-6 rounded-2xl"},re={class:"text-gray-500 mb-6"},ie=["id"],ue=["src"],de={class:"font-semibold"},ce={class:"text-sm text-gray-400"},me={class:"flex items-center ml-10"},fe={class:"flex justify-center text-2xl items-center mt-2"},ve={class:"mb-2"},be={class:"flex items-center space-x-4"},xe={key:0,class:"text-center py-4"},ge={key:1,class:"text-center py-4 text-gray-400"},he={__name:"Reviews",props:{bookId:{type:[String,Number],required:!0}},setup(s){const f=s,u=x([]),b=x(1),n=x(null),o=x(!1),c=async()=>{if(!o.value&&!(n.value&&b.value>n.value)){o.value=!0;try{const v=await ae.getReviews(f.bookId,b.value);u.value.push(...v.data.data),n.value=v.data.last_page,b.value++}finally{o.value=!1}}},t=()=>{const{scrollTop:v,clientHeight:g,scrollHeight:r}=document.documentElement};return O(()=>{c(),window.addEventListener("scroll",t)}),W(()=>{window.removeEventListener("scroll",t)}),(v,g)=>(i(),d("section",ne,[g[0]||(g[0]=e("h2",{class:"text-4xl font-bold mb-4"},"Reader Reviews",-1)),e("p",re,"Total loaded: "+a(u.value.length),1),(i(!0),d(p,null,y(u.value,r=>(i(),d("div",{key:r.id,class:"mb-6 p-4 bg-white rounded-xl shadow"},[e("div",{class:"flex items-center mb-2",id:"review-id-"+r.id},[e("img",{src:r.user.profile_picture,class:"w-12 h-12 rounded-full mr-3"},null,8,ue),e("div",null,[e("p",de,a(r.user.name),1),e("p",ce," @"+a(r.user.username)+" • "+a(j(D)(r.created_at)),1)]),e("div",me,[e("div",fe,[(i(),d(p,null,y(5,h=>e("span",{key:h},[e("i",{class:k(["text-yellow",h<=r.rating/2?"fa-solid fa-star":"fa-regular fa-star"])},null,2)])),64))])])],8,ie),e("p",ve,a(r.comment),1),e("div",be,[R(se,{count:r.likes,liked:r.is_liked,id:r.id,like_what:"review"},null,8,["count","liked","id"]),R(ee,{whoToFollow:r.user.id},null,8,["whoToFollow"])])]))),128)),o.value?(i(),d("div",xe,"Loading more…")):n.value&&b.value>n.value?(i(),d("div",ge," No more reviews. ")):B("",!0)]))}},pe={__name:"FollowAuthorButton",props:H({author:{required:!0,type:Object}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const f=Y(s,"modelValue"),u=async b=>{try{const n=await te.followAuthor(b);n.status===200?f.value=!f.value:console.log(n.data)}catch(n){console.log(n)}};return(b,n)=>(i(),d("button",{onClick:n[0]||(n[0]=o=>{var c,t;return u((t=(c=s.author)==null?void 0:c.data)==null?void 0:t.id)}),class:"mt-2 bg-dark_blue text-white px-10 py-1 rounded-full text-sm hover:bg-light_blue"},a(f.value?"Unfollow":"Follow"),1))}},_e={key:0,class:"relative mx-auto my-16 max-w-5xl bg-primary p-6 rounded-2xl shadow"},ye={class:"flex flex-col lg:flex-row gap-6 items-start"},we=["src"],ke={class:"flex-1 space-y-4"},$e={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Be={class:"text-3xl font-bold"},Re={class:"text-gray-600"},je={class:"font-semibold text-dark_blue"},Se={class:"font-semibold"},Ce={class:"text-gray-700"},Fe={class:"mx-auto max-w-4xl"},Ve={class:"relative h-[580px] w-full [perspective:2000px]"},Te={class:"absolute inset-0 backface-hidden flex flex-col items-center justify-center rounded-2xl bg-orange p-8 text-center space-y-6 shadow-lg"},Ae={class:"flex items-center justify-center text-yellow mb-2"},Me={class:"text-gray-700"},Ne={class:"absolute inset-0 rotate-y-180 backface-hidden flex items-center justify-center rounded-2xl bg-primary p-6"},ze={key:0,class:"absolute inset-0"},qe={class:"text-center space-y-2"},De=["src"],Oe={class:"text-lg font-semibold"},Pe={class:"text-gray-600"},Ee={class:"flex justify-center gap-2 text-4xl"},Ie=["onClick"],Le={class:"flex justify-end gap-3"},Ue=["disabled"],We={__name:"Author",props:{author:{type:Object,required:!0},book:{type:Object,required:!0}},setup(s){const f=s,u=P();E();const b=I(),n=x(!1),o=x(!1),c=x(!1),t=x(0),v=x(""),g=F(()=>v.value.trim().length>0),r=F(()=>t.value>0&&g.value&&!o.value);async function h(){if(!r.value){u.warning("Please rate the book and write a short comment first.");return}o.value=!0;try{await C.rateBook({rating:t.value,comment:v.value,book_id:f.book.id});const{data:_}=await C.getBookReviews(f.book.id);b.reviews=_,c.value=!0,setTimeout(()=>{c.value=!1,v.value="",t.value=0,n.value=!1},3e3),u.success("Thanks for your review!")}catch{}finally{o.value=!1}}return(_,l)=>(i(),d(p,null,[s.author?(i(),d("section",_e,[e("div",ye,[e("img",{src:s.author.data.author_picture,alt:"Author avatar",class:"size-40 shrink-0 rounded-full object-cover"},null,8,we),e("div",ke,[e("header",$e,[e("h2",Be,a(s.author.data.name),1),R(pe,{modelValue:s.author.isFollowed,"onUpdate:modelValue":l[0]||(l[0]=m=>s.author.isFollowed=m),author:s.author},null,8,["modelValue","author"])]),e("p",Re,[l[4]||(l[4]=$(" Books: ")),e("span",je,a(s.author.books_count||0),1),l[5]||(l[5]=$(" · Followers: ")),e("span",Se,a(s.author.data.followers_count||0),1)]),e("p",Ce,a(s.author.data.about_author),1)])])])):B("",!0),e("section",Fe,[e("div",Ve,[e("div",{class:k([["absolute inset-0 transition-transform duration-700",{"rotate-y-180":n.value}],"w-full h-full [transform-style:preserve-3d]"])},[e("div",Te,[l[6]||(l[6]=e("h1",{class:"font-tangerine text-5xl sm:text-6xl"},"Rating & Reviews",-1)),l[7]||(l[7]=e("img",{src:"https://randomuser.me/api/portraits/women/44.jpg",alt:"avatar",class:"size-24 rounded-full"},null,-1)),l[8]||(l[8]=e("p",{class:"text-lg"},"What do you think?",-1)),e("div",null,[e("div",Ae,[(i(),d(p,null,y(5,m=>e("i",{key:m,class:k([m<=4?"fa-solid fa-star":"fa-regular fa-star","mx-1 text-xl"])},null,2)),64))]),e("p",Me,"4.5 ("+a(s.book.ratings_count)+" ratings · "+a(s.book.reviews_count)+" reviews)",1)]),e("button",{onClick:l[1]||(l[1]=m=>n.value=!0),class:"rounded-xl bg-dark_blue px-6 py-3 font-semibold text-white hover:bg-light_blue"},"Write a Review")]),e("div",Ne,[e("form",{onSubmit:J(h,["prevent"]),class:"w-full max-w-lg space-y-6 bg-orange p-6 rounded-2xl shadow-lg relative"},[c.value?q((i(),d("div",ze,null,512)),[[j(oe),{particleCount:800}]]):B("",!0),e("header",qe,[l[9]||(l[9]=e("h2",{class:"text-2xl font-bold"},"Write a Review",-1)),e("img",{src:s.book.image,alt:"book cover",class:"mx-auto size-24 rounded object-cover"},null,8,De),e("h3",Oe,a(s.book.title),1),e("p",Pe,a(s.book.author.data.name),1)]),e("div",Ee,[(i(),d(p,null,y(5,m=>e("span",{key:m,class:k(["cursor-pointer transition-transform",m<=t.value?"text-yellow scale-110":"text-gray-300"]),onClick:S=>t.value=m},"★",10,Ie)),64))]),q(e("textarea",{"onUpdate:modelValue":l[2]||(l[2]=m=>v.value=m),rows:"4",placeholder:"Your thoughts…",class:"w-full resize-none rounded-xl p-3 placeholder-gray-400"},null,512),[[K,v.value]]),e("div",Le,[e("button",{type:"button",onClick:l[3]||(l[3]=m=>n.value=!1),class:"rounded-xl border-2 border-dark_blue px-4 py-2 font-medium"},"Cancel"),e("button",{disabled:!r.value,class:"rounded-xl bg-dark_blue px-4 py-2 font-medium text-white disabled:opacity-50 disabled:cursor-not-allowed"},a(o.value?"Submitting…":"Submit"),9,Ue)])],32)])],2)])])],64))}},He=G(We,[["__scopeId","data-v-b4a93a10"]]),Ye={key:0,class:"min-h-screen p-6 bg-primary text-gray-900"},Ge={class:"grid grid-cols-12 gap-8"},Je={class:"col-span-4"},Ke={class:"p-4 rounded-2xl shadow-md"},Qe=["src"],Xe={class:"col-span-8 p-8 rounded-2xl shadow-md"},Ze={class:"text-3xl font-bold mb-2"},et={class:"text-xl mb-4"},tt={class:"flex items-center mb-4"},st={class:"flex justify-center text-2xl items-center mt-2"},ot={class:"ml-2 text-lg"},lt={class:"text-gray-700 mb-6"},at={class:"flex flex-wrap mb-4"},nt={class:"mt-8 grid grid-cols-2 gap-4"},rt={class:"text-gray-600"},it={class:"mt-8"},ut={class:"mt-2"},dt={__name:"Book",setup(s){const f=I(),u=E(),b=P(),n=Q();O(async()=>{try{u.loading=!0;const c=await C.getBookDetails(n.params.id);c.status===200?f.book=c.data:b.error(c.data.message)}catch(c){b.error("Oops! "+c)}finally{u.loading=!1}});const o=F(()=>f.book);return(c,t)=>{var v,g,r,h,_,l,m,S,V,T,A,M,N;return o.value?(i(),d("main",Ye,[e("div",Ge,[e("div",Je,[e("div",Ke,[e("img",{src:(v=o.value)==null?void 0:v.image,alt:"Book Cover",class:"rounded-lg w-full h-auto"},null,8,Qe),t[0]||(t[0]=e("div",{class:"mt-4"},[e("button",{class:"w-full bg-dark_blue text-white py-2 rounded-xl mb-2 hover:bg-blue-700"},"Currently Reading"),e("button",{class:"w-full bg-gray-300 text-gray-700 py-2 rounded-xl mb-2 hover:bg-gray-400"},"Want to Read"),e("button",{class:"w-full bg-gray-100 text-gray-700 py-2 rounded-xl hover:bg-gray-200"},"Finished Reading")],-1))])]),e("div",Xe,[e("h1",Ze,a((g=o.value)==null?void 0:g.title),1),e("h2",et,a((h=(r=o.value)==null?void 0:r.author)==null?void 0:h.name),1),e("div",tt,[e("div",st,[(i(),d(p,null,y(5,w=>{var z;return e("span",{key:w},[e("i",{class:k(["text-yellow",w<=((z=o.value)==null?void 0:z.average_rating)/2?"fa-solid fa-star":"fa-regular fa-star"])},null,2)])}),64))]),e("span",ot,a((_=o.value)==null?void 0:_.rating),1)]),e("p",lt,[t[1]||(t[1]=e("br",null,null,-1)),t[2]||(t[2]=e("br",null,null,-1)),$(" "+a((l=o.value)==null?void 0:l.description),1)]),e("div",at,[(i(!0),d(p,null,y((m=o.value)==null?void 0:m.categories,w=>(i(),d("span",{key:w,class:"bg-light_blue py-1 px-2 rounded-full mr-2 mb-2 hover:bg-gray hover:cursor-pointer"},a(w.category_name),1))),128))]),e("div",nt,[e("div",null,[t[3]||(t[3]=e("h3",{class:"text-lg font-semibold"},"Publication Details",-1)),e("ul",rt,[e("li",null,"Published: "+a(j(D)((S=o.value)==null?void 0:S.created_at)),1)])])]),e("div",it,[e("p",null,[t[4]||(t[4]=e("i",{class:"fas fa-user"},null,-1)),$(" "+a((T=(V=o.value)==null?void 0:V.readers_stats)==null?void 0:T.reading)+" people are currently reading",1)]),e("p",ut,[t[5]||(t[5]=e("i",{class:"fas fa-user"},null,-1)),$(" "+a((M=(A=o.value)==null?void 0:A.readers_stats)==null?void 0:M.want)+" people want to read",1)])])])]),R(He,{author:(N=o.value)==null?void 0:N.author,book:o.value},null,8,["author","book"]),o.value?(i(),L(he,{key:0,"book-id":j(n).params.id},null,8,["book-id"])):B("",!0),t[6]||(t[6]=e("h1",{id:"xyz"},null,-1))])):B("",!0)}}},_t={__name:"Book",props:{book_id:{type:String,required:!0}},setup(s){return(f,u)=>(i(),L(U,null,{default:X(()=>[R(dt,{id:s.book_id},null,8,["id"])]),_:1}))}};export{_t as default};
